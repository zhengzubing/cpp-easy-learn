# C++20 概念与约束（Concepts）

## 1. 基本用法示例

```cpp
#include <concepts>
#include <iostream>
using namespace std;

// 定义 Numeric 概念，约束为算术类型
template <typename T>
concept Numeric = std::is_arithmetic_v<T>;

// 使用概念约束模板参数
template <Numeric T>
T multiply(T a, T b) {
    return a * b;
}

int main() {
    cout << multiply(3, 4) << endl;     // 输出 12
    // cout << multiply("a", "b") << endl; // 编译错误，非Numeric类型
    return 0;
}
```

> 传统模板 `template <typename T>`，T 可以是任何类型。  
> 使用概念约束后，`template <Numeric T>` 限定了 T 必须满足 Numeric 概念。

---

## 2. 约束的多种用法

### 2.1 直接在模板参数中约束

```cpp
template <std::integral T>
T square(T x) {
    return x * x;
}
```

### 2.2 在返回类型处使用 requires

```cpp
#include <concepts>
#include <iostream>

template <typename T>
auto multiply(T a, T b) -> requires std::integral<T> {
    return a * b;
}

int main() {
    std::cout << multiply(3, 4) << std::endl; // 正常工作
    // std::cout << multiply(3.1, 4.2) << std::endl; // 编译错误
    return 0;
}
```

### 2.3 约束 auto 形参

```cpp
#include <concepts>
#include <iostream>

void printNumber(std::integral auto number) {
    std::cout << number << std::endl;
}

int main() {
    printNumber(42);   // 正常工作
    // printNumber(3.14); // 编译错误
    return 0;
}
```